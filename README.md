# OptF_in_Merton_structure_to_Cal_D-E
OptF_in_Merton_structure_to_Cal_DE

Optimal F 應用於公司舉債比例（含稅盾與破產成本）模型
=============================================================

【模型目標】
-------------
求解最優舉債比例 f*，在考慮稅盾效應與破產成本下，最大化公司價值 V。

【模型假設】
-------------
1. 公司總資產（營運資產）為 A，舉債比例 f = D / V（其中 D 為債務）。
2. 稅盾效應：利息支出可抵稅，稅盾現值為 τ D (1 - PD)，破產時稅盾失效。
3. 預期破產成本：破產發生時，公司價值損失 α A，加權後為 PD ⋅ α A。
4. 破產機率（PD）使用默頓結構信用風險模型推算，假設資產價值服從對數常態分布。
5. 假設公司價值近似營運資產 V ≈ A（簡化模型）。

【公司價值公式】
-----------------
公司價值 V：

V = A + 稅盾現值 - 預期破產成本

公式展開：

V = A + τ D (1 - PD) - PD ⋅ α A

代入 D = fA，簡化為：

V = A [1 + τ f (1 - PD) - α PD]

【破產機率（PD）公式】
-----------------------
使用默頓模型：

PD = N( (ln f - (r - σ_A² / 2)T) / (σ_A √T) )

其中：
- N(·)：標準正態累積分布函數
- r：無風險利率
- σ_A：資產波動率
- T：債務期限

存活機率（勝率）：

p = 1 - PD = N( (-ln f + (r - σ_A² / 2)T) / (σ_A √T) )

【最優槓桿比例 f* 推導過程】
-----------------------------------
最大化公司價值 V，對舉債比例 f 求一階導數並令其等於0：

dV/df = A [ τ (1 - PD) - (τ f + α) ⋅ dPD/df ] = 0

破產機率對舉債比例導數：

dPD/df = n(z) / (σ_A √T ⋅ f)

其中：
- z = (ln f - (r - σ_A² / 2)T) / (σ_A √T)
- n(z) = (1/√(2π)) e^(-z² / 2)：標準正態密度函數

將上述導入導數公式：

τ (1 - PD) = (τ f + α) ⋅ n(z) / (σ_A √T ⋅ f)

【最終隱式方程】
----------------
最優槓桿比例 f* 滿足以下隱式方程：

f* = [ α ⋅ (1/√(2π)) e^(-z² / 2) ] / [ τ (σ_A √T (1 - N(z)) - (1/√(2π)) e^(-z² / 2)) ]

其中：
z = (ln f* - (r - σ_A² / 2)T) / (σ_A √T)

【公式特性】
-------------
- 這是一個非線性隱式方程，因 z 依賴 f*，無法解析求解，需使用數值方法。
- 參數影響：
  - 稅率 τ ↑ → 稅盾效應提升，f* 增加。
  - 破產成本比例 α ↑ → 預期破產成本提升，f* 減少。
  - 資產波動率 σ_A ↑ → 破產機率上升，f* 減少。
  - 債務期限 T ↑ → 破產風險可能增大，f* 減少。

【數值求解流程】
-----------------
1. 定義公司價值函數：

V(f) = A [1 + τ f (1 - N(z)) - α N(z)]

其中：

z = (ln f - (r - σ_A² / 2)T) / (σ_A √T)

2. 使用數值方法（如牛頓法、二分法、網格搜索）找到最大化 V(f) 的舉債比例 f*。

【示例參數】
-------------
- A = 100
- τ = 0.3
- α = 0.2
- r = 0.05
- σ_A = 0.3
- T = 1

數值求解結果：
- f* ≈ 0.4 ~ 0.5（具體值依參數而定）

【結論】
---------
- 最優槓桿比例 f* 平衡稅盾效應與破產風險，可用於企業資本結構決策。
- 需依公司具體參數進行數值求解，確定最佳舉債比例。
